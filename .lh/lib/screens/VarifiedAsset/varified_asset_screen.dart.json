{
    "sourceFile": "lib/screens/VarifiedAsset/varified_asset_screen.dart",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 0,
            "patches": [
                {
                    "date": 1752144406510,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                }
            ],
            "date": 1752144406510,
            "name": "Commit-0",
            "content": "import 'package:fats_client/Services/VarifiedAsset/VarifiedAssetServices.dart';\nimport 'package:fats_client/models/VarifiedAssetModel.dart';\nimport 'package:flutter/material.dart';\nimport 'package:flutter/services.dart';\nimport 'package:get/get.dart';\n\nimport '../../Services/AssetVarification/DeleteTag.dart';\nimport '../../constants.dart';\nimport '../AssetForPrinting/BarcodeLabelScreen.dart';\n\nclass VarifiedAssetScreen extends StatefulWidget {\n  const VarifiedAssetScreen({super.key});\n\n  @override\n  State<VarifiedAssetScreen> createState() => _VarifiedAssetScreenState();\n}\n\nclass _VarifiedAssetScreenState extends State<VarifiedAssetScreen> {\n  List<VarifiedAssetModel> varifiedAssetModel = [];\n  List<bool> isMarked = [];\n  int rowsPerPage = PaginatedDataTable.defaultRowsPerPage;\n  bool isLoading = true;\n\n  @override\n  void initState() {\n    super.initState();\n\n    Future.delayed(\n      Duration.zero,\n      () {\n        VarifiedAssetServices.varifiedAsset().then(\n          (response) {\n            varifiedAssetModel = response;\n            for (int i = 0; i < varifiedAssetModel.length; i++) {\n              isMarked.add(false);\n            }\n            setState(() {\n              isLoading = false;\n            });\n          },\n        ).onError(\n          (error, stackTrace) {\n            Navigator.pop(context);\n            print(\"Error is: $error\");\n            setState(() {\n              isLoading = false;\n            });\n          },\n        );\n      },\n    );\n  }\n\n  TextEditingController searchController = TextEditingController();\n\n  @override\n  Widget build(BuildContext context) {\n    return Scaffold(\n      appBar: AppBar(\n        title: const Text('Verified Assets'),\n        centerTitle: true,\n        elevation: 0,\n        backgroundColor: Constant.primaryColor,\n        foregroundColor: Colors.white,\n      ),\n      // floatingActionButton: FloatingActionButton.extended(\n      //   onPressed: () {\n      //     List<String> _tagNumber = [];\n      //     List<String> _assetDescription = [];\n      //     List<String> _barcodeInfo = [];\n\n      //     for (int i = 0; i < isMarked.length; i++) {\n      //       if (isMarked[i]) {\n      //         _tagNumber.add(varifiedAssetModel[i].tagNumber!);\n      //         _assetDescription.add(varifiedAssetModel[i].aSSETdESCRIPTION!);\n      //         _barcodeInfo.add(\"${varifiedAssetModel[i].tagNumber!} \" +\n      //             varifiedAssetModel[i].minorCategoryDescription!);\n      //       }\n      //     }\n\n      //     if (_tagNumber.isEmpty) {\n      //       ScaffoldMessenger.of(context).showSnackBar(\n      //         const SnackBar(\n      //           content: Text('Please select at least one asset'),\n      //           backgroundColor: Colors.red,\n      //         ),\n      //       );\n      //     } else {\n      //       Get.to(() => BarcodeLabelScreen(\n      //             tagNumber: _tagNumber,\n      //             assetDescription: _assetDescription,\n      //             qrCode: _barcodeInfo,\n      //           ));\n      //     }\n      //   },\n      //   label: const Text('Print Asset'),\n      //   icon: const Icon(Icons.print),\n      // ),\n      body: isLoading == true\n          ? Center(\n              child: CircularProgressIndicator(\n                color: Constant.primaryColor,\n                strokeWidth: 5,\n                strokeCap: StrokeCap.round,\n              ),\n            )\n          : varifiedAssetModel.isEmpty\n              ? Center(\n                  child: Image.network(Constant.placeHolderImage),\n                )\n              : Stack(\n                  children: [\n                    SingleChildScrollView(\n                      child: Column(\n                        children: [\n                          PaginatedDataTable(\n                            header: const Text(\n                              'Verified Assets',\n                              style: TextStyle(\n                                color: Colors.black,\n                                fontSize: 13,\n                              ),\n                            ),\n                            headingRowColor: MaterialStateProperty.all(\n                                Constant.primaryColor),\n                            rowsPerPage: rowsPerPage,\n                            onRowsPerPageChanged: (value) {\n                              setState(() {\n                                rowsPerPage = value ??\n                                    PaginatedDataTable.defaultRowsPerPage;\n                              });\n                            },\n                            columns: [\n                              dataColumWidget(\"Mark\"),\n                              dataColumWidget(\"Id\"),\n                              dataColumWidget(\"Major Category\"),\n                              dataColumWidget(\"Major Category Description\"),\n                              dataColumWidget(\"Minor Category\"),\n                              dataColumWidget(\"Minor Category Description\"),\n                              dataColumWidget(\"Tag Number\"),\n                              dataColumWidget(\"Serial Number\"),\n                              dataColumWidget(\"Asset Description\"),\n                              dataColumWidget(\"Asset Type\"),\n                              dataColumWidget(\"Asset Condition\"),\n                              dataColumWidget(\"Manufacturer\"),\n                              dataColumWidget(\"Model Manufacturer\"),\n                              dataColumWidget(\"Country\"),\n                              dataColumWidget(\"City\"),\n                              dataColumWidget(\"Region\"),\n                              dataColumWidget(\"Department Code\"),\n                              dataColumWidget(\"Department Name\"),\n                              dataColumWidget(\"Business Unit\"),\n                              dataColumWidget(\"Building Number\"),\n                              dataColumWidget(\"Floor Number\"),\n                              dataColumWidget(\"Employee Id\"),\n                              dataColumWidget(\"PO Number\"),\n                              dataColumWidget(\"Delivery Note Number\"),\n                              dataColumWidget(\"Supplier\"),\n                              dataColumWidget(\"Invoice Number\"),\n                              dataColumWidget(\"Invoice Date\"),\n                              dataColumWidget(\"Ownership\"),\n                              dataColumWidget(\"Bought\"),\n                              dataColumWidget(\"Terminal Id\"),\n                              dataColumWidget(\"ATM Number\"),\n                              dataColumWidget(\"Location Tag\"),\n                              dataColumWidget(\"Building Name\"),\n                              dataColumWidget(\"Building Address\"),\n                              dataColumWidget(\"User Login Id\"),\n                              dataColumWidget(\"Main Sub Series\"),\n                              dataColumWidget(\n                                  \"Major Categories Plus Minor Categories\"),\n                              dataColumWidget(\"Asset Date Captured\"),\n                              dataColumWidget(\"Asset Time Captured\"),\n                              dataColumWidget(\"Asset Date Scanned\"),\n                              dataColumWidget(\"Asset Time Scanned\"),\n                              dataColumWidget(\"Qty\"),\n                              dataColumWidget(\"Phone Exit Number\"),\n                              dataColumWidget(\"Full Location Details\"),\n                              dataColumWidget(\"Journal Ref No\"),\n                              dataColumWidget(\"Images\"),\n                              dataColumWidget(\"Delete\"),\n                            ],\n                            source: VarifiedAssetDataSource(\n                                context: context,\n                                varifiedAssetModel: varifiedAssetModel,\n                                isMarked: isMarked,\n                                setState: setState),\n                          ),\n                        ],\n                      ),\n                    ),\n                    Positioned(\n                      right: 10,\n                      top: 10,\n                      child: ElevatedButton(\n                        style: ElevatedButton.styleFrom(\n                          backgroundColor: Constant.primaryColor,\n                        ),\n                        onPressed: () {\n                          List<String> _tagNumber = [];\n                          List<String> _assetDescription = [];\n                          List<String> _barcodeInfo = [];\n\n                          for (int i = 0; i < isMarked.length; i++) {\n                            if (isMarked[i]) {\n                              _tagNumber.add(varifiedAssetModel[i].tagNumber!);\n                              _assetDescription\n                                  .add(varifiedAssetModel[i].aSSETdESCRIPTION!);\n                              _barcodeInfo.add(\n                                  \"${varifiedAssetModel[i].tagNumber!} \" +\n                                      varifiedAssetModel[i]\n                                          .minorCategoryDescription!);\n                            }\n                          }\n\n                          if (_tagNumber.isEmpty) {\n                            ScaffoldMessenger.of(context).showSnackBar(\n                              const SnackBar(\n                                content:\n                                    Text('Please select at least one asset'),\n                                backgroundColor: Colors.red,\n                              ),\n                            );\n                          } else {\n                            Get.to(() => BarcodeLabelScreen(\n                                  tagNumber: _tagNumber,\n                                  assetDescription: _assetDescription,\n                                  qrCode: _barcodeInfo,\n                                ));\n                          }\n                        },\n                        child: const Text(\n                          'Print Asset',\n                          style: TextStyle(\n                            color: Colors.white,\n                          ),\n                        ),\n                      ),\n                    ),\n                  ],\n                ),\n    );\n  }\n\n  DataColumn dataColumWidget(String label) {\n    return DataColumn(\n      label: Text(\n        label,\n        style: const TextStyle(\n          color: Colors.white,\n        ),\n      ),\n    );\n  }\n}\n\nclass VarifiedAssetDataSource extends DataTableSource {\n  final BuildContext context;\n  final List<VarifiedAssetModel> varifiedAssetModel;\n  final List<bool> isMarked;\n  final void Function(VoidCallback fn) setState;\n\n  VarifiedAssetDataSource({\n    required this.context,\n    required this.varifiedAssetModel,\n    required this.isMarked,\n    required this.setState,\n  });\n\n  @override\n  DataRow getRow(int index) {\n    final asset = varifiedAssetModel[index];\n    return DataRow(\n      cells: [\n        DataCell(Checkbox(\n          value: isMarked[index],\n          onChanged: (value) {\n            setState(() {\n              isMarked[index] = value!;\n            });\n          },\n        )),\n        DataCell(Text((index + 1).toString())),\n        DataCell(Text(asset.majorCategory ?? '')),\n        DataCell(Text(asset.majorCategoryDescription ?? '')),\n        DataCell(Text(asset.mInorCategory ?? '')),\n        DataCell(Text(asset.minorCategoryDescription ?? '')),\n        DataCell(\n          Row(\n            mainAxisAlignment: MainAxisAlignment.spaceAround,\n            children: [\n              SelectableText(asset.tagNumber ?? \"\"),\n              IconButton(\n                onPressed: () {\n                  Clipboard.setData(ClipboardData(text: asset.tagNumber ?? \"\"));\n                  ScaffoldMessenger.of(context).showSnackBar(\n                    const SnackBar(\n                      content: Text('Tag Number Copied to Clipboard'),\n                      backgroundColor: Colors.black,\n                    ),\n                  );\n                },\n                icon: const Icon(\n                  Icons.copy,\n                  color: Colors.grey,\n                ),\n              ),\n            ],\n          ),\n        ),\n        DataCell(Text(asset.sERIALnUMBER ?? '')),\n        DataCell(Text(asset.aSSETdESCRIPTION ?? '')),\n        DataCell(Text(asset.assettYPE ?? '')),\n        DataCell(Text(asset.aSSETcONDITION ?? '')),\n        DataCell(Text(asset.manufacturer ?? '')),\n        DataCell(Text(asset.modelofAsset ?? '')),\n        DataCell(Text(asset.rEGION ?? '')),\n        DataCell(Text(asset.cOUNTRY ?? '')),\n        DataCell(Text(asset.cityName ?? '')),\n        DataCell(Text(asset.dao ?? '')),\n        DataCell(Text(asset.daoName ?? '')),\n        DataCell(Text(asset.businessUnit ?? '')),\n        DataCell(Text(asset.bUILDINGNO ?? '')),\n        DataCell(Text(asset.fLOORNO ?? '')),\n        DataCell(Text(asset.eMPLOYEEID ?? '')),\n        DataCell(Text(asset.ponUmber ?? '')),\n        DataCell(Text(asset.deliveryNoteNo ?? '')),\n        DataCell(Text(asset.supplier ?? '')),\n        DataCell(Text(asset.invoiceNo ?? '')),\n        DataCell(Text(asset.invoiceDate ?? '')),\n        DataCell(Text(asset.ownership ?? '')),\n        DataCell(Text(asset.bought ?? '')),\n        DataCell(Text(asset.terminalID ?? '')),\n        DataCell(Text(asset.aTMNumber ?? '')),\n        DataCell(Text(asset.locationTag ?? '')),\n        DataCell(Text(asset.buildingName ?? '')),\n        DataCell(Text(asset.buildingAddress ?? '')),\n        DataCell(Text(asset.userLoginID ?? '')),\n        DataCell(Text(asset.mainSubSeriesNo?.toString() ?? '')),\n        const DataCell(Text('')),\n        DataCell(Text(asset.assetdatecaptured ?? '')),\n        DataCell(Text(asset.assetTimeCaptured ?? '')),\n        DataCell(Text(asset.assetdatescanned ?? '')),\n        DataCell(Text(asset.assettimeScanned ?? '')),\n        DataCell(Text(asset.qTY?.toString() ?? '')),\n        DataCell(Text(asset.phoneExtNo ?? '')),\n        DataCell(Text(asset.fullLocationDetails ?? '')),\n        DataCell(Text(asset.journalRefNo ?? '')),\n        DataCell(Text(asset.images ?? '')),\n        DataCell(\n          IconButton(\n            onPressed: () {\n              showDialog(\n                context: context,\n                builder: (context) => AlertDialog(\n                  title:\n                      const Text('Are you sure you want to delete this asset?'),\n                  actions: [\n                    TextButton(\n                      onPressed: () {\n                        Navigator.pop(context);\n                      },\n                      child: const Text('No'),\n                    ),\n                    TextButton(\n                      onPressed: () async {\n                        Constant.showLoadingDialog(context);\n                        await DeleteTagServices.deleteTag(\n                            asset.tagNumber ?? '');\n                        Navigator.pop(context);\n                        Navigator.pop(context);\n\n                        setState(() {\n                          varifiedAssetModel.removeAt(index);\n                        });\n                      },\n                      child: const Text('Yes'),\n                    ),\n                  ],\n                ),\n              );\n            },\n            icon: const Icon(\n              Icons.delete,\n              color: Colors.red,\n            ),\n          ),\n        ),\n      ],\n    );\n  }\n\n  @override\n  int get rowCount => varifiedAssetModel.length;\n\n  @override\n  bool get isRowCountApproximate => false;\n\n  @override\n  int get selectedRowCount => isMarked.where((marked) => marked).length;\n}\n"
        }
    ]
}